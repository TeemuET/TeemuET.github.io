<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Investigation into Online Calibrated Bayesian Optimization | Teemu Turpeinen </title> <meta name="author" content="Teemu Elmeri Turpeinen"> <meta name="description" content="An overview of my work at the Probabilistic Machine Learning Group, Summer 2025."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://teemuet.github.io/projects/calibrated_BO/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Teemu Turpeinen </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Investigation into Online Calibrated Bayesian Optimization</h1> <p class="post-description">An overview of my work at the Probabilistic Machine Learning Group, Summer 2025.</p> </header> <article> <h2 id="introduction">Introduction</h2> <p>During the summer of 2025, I served as a Research Assistant within the <strong>Probabilistic Machine Learning Group</strong> at Aalto University’s Department of Computer Science. Working under the supervision of Prof. Samuel Kaski and doctoral student Marshal Sinaga, my research focused on enhancing the robustness of <strong>Bayesian Optimization (BO)</strong>. Specifically, I investigated how model calibration and conformal prediction could be used to provide more reliable uncertainty quantification during the optimization of expensive black-box functions.</p> <p>The fundamental objective in BO is to find the global optimum of an expensive-to-evaluate black-box function</p> \[x^*=\arg \max_{x\in\mathcal{X}} f(x).\] <p>The black-box function $f$ is approximated with a surrogate model (most often a Gaussian Process (GP)) which is iteratively updated as new data points are sampled via an <strong>acquisition function</strong>. Acquisition functions balance the exploration-exploitation trade-off. That is, we must exploit regions where the surrogate predicts high objective values while simultaneously exploring regions with high predictive uncertainty where a global optimum might remain hidden. In this context, accurate uncertainty quantification is essential for decision-making and the performance of BO. <strong>My research specifically addressed how to guarantee BO performance bounds even under model misspecification, primarily by exploring the trade-off between calibration and sharpness. While the project involved a deep dive into the literature of conformal prediction, my core experimental work focused on implementing and evaluating online calibration strategies.</strong></p> <h2 id="research-questions">Research Questions</h2> <p>After a comprehensive literature review, the research shifted toward addressing specific gaps in how online calibration affects optimization performance. My work aimed to resolve the following three questions:</p> <ul> <li> <strong>Calibration vs. Performance</strong>: How are calibration, sharpness, and proper scores fundamentally connected to Bayesian Optimization (BO) performance?</li> <li> <strong>Methodological Advancements</strong>: Is the new online method proposed by Deshpande et al. (2024) <a class="citation" href="#pmlr-v238-deshpande24a">(Deshpande et al., 2024)</a> fundamentally different from the older methods that sparked initial critiques of recalibrated BO?</li> <li> <strong>Optimization Focus</strong>: Ultimately, what should the focus be (calibration, sharpness or a balance between the two) to achieve superior BO performance?</li> </ul> <h2 id="presentation">Presentation</h2> <p>For a more complete view of the project, you can read my final presentation slides here <a href="/assets/pdf/onlineCalib_presentation.pdf">PDF</a> or view them below.</p> <div class="row mt-3"> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-1-480.webp 480w,/assets/img/slide-1-800.webp 800w,/assets/img/slide-1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-1.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-2-480.webp 480w,/assets/img/slide-2-800.webp 800w,/assets/img/slide-2-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-2.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-3-480.webp 480w,/assets/img/slide-3-800.webp 800w,/assets/img/slide-3-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-3.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-4-480.webp 480w,/assets/img/slide-4-800.webp 800w,/assets/img/slide-4-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-4.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-5-480.webp 480w,/assets/img/slide-5-800.webp 800w,/assets/img/slide-5-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-5.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-6-480.webp 480w,/assets/img/slide-6-800.webp 800w,/assets/img/slide-6-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-6.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-7-480.webp 480w,/assets/img/slide-7-800.webp 800w,/assets/img/slide-7-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-7.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-8-480.webp 480w,/assets/img/slide-8-800.webp 800w,/assets/img/slide-8-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-8.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-9-480.webp 480w,/assets/img/slide-9-800.webp 800w,/assets/img/slide-9-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-9.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-10-480.webp 480w,/assets/img/slide-10-800.webp 800w,/assets/img/slide-10-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-10.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-11-480.webp 480w,/assets/img/slide-11-800.webp 800w,/assets/img/slide-11-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-11.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-12-480.webp 480w,/assets/img/slide-12-800.webp 800w,/assets/img/slide-12-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-12.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-13-480.webp 480w,/assets/img/slide-13-800.webp 800w,/assets/img/slide-13-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-13.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-14-480.webp 480w,/assets/img/slide-14-800.webp 800w,/assets/img/slide-14-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-14.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-15-480.webp 480w,/assets/img/slide-15-800.webp 800w,/assets/img/slide-15-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-15.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-16-480.webp 480w,/assets/img/slide-16-800.webp 800w,/assets/img/slide-16-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-16.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-17-480.webp 480w,/assets/img/slide-17-800.webp 800w,/assets/img/slide-17-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-17.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/slide-18-480.webp 480w,/assets/img/slide-18-800.webp 800w,/assets/img/slide-18-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/slide-18.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h2 id="source-code">Source Code</h2> <p>The repository for the experiment framework is available <a href="https://github.com/TeemuET/online-calibrated-bo-experiments" rel="external nofollow noopener" target="_blank">here</a>. The repository builds on the work by Foldager et al. <a class="citation" href="#pmlr-v216-foldager23a">(Foldager et al., 2023)</a>.</p> </article> <h2>References</h2> <div class="publications"> <h2 class="bibliography">2024</h2> <ol class="bibliography"><li> <div class="row"> <div class="col col-sm-2 abbr"> <abbr class="badge rounded w-100">PMLR</abbr> </div> <div id="pmlr-v238-deshpande24a" class="col-sm-8"> <div class="title">Online Calibrated and Conformal Prediction Improves Bayesian Optimization</div> <div class="author"> Shachi Deshpande, Charles Marx, and Volodymyr Kuleshov </div> <div class="periodical"> <em>In Proceedings of The 27th International Conference on Artificial Intelligence and Statistics</em>, 02–04 may 2024 </div> <div class="periodical"> </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a href="https://proceedings.mlr.press/v238/deshpande24a/deshpande24a.pdf" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">PDF</a> </div> <div class="abstract hidden"> <p>Accurate uncertainty estimates are important in sequential model-based decision-making tasks such as Bayesian optimization. However, these estimates can be imperfect if the data violates assumptions made by the model (e.g., Gaussianity). This paper studies which uncertainties are needed in model-based decision-making and in Bayesian optimization, and argues that uncertainties can benefit from calibration—i.e., an 80% predictive interval should contain the true outcome 80% of the time. Maintaining calibration, however, can be challenging when the data is non-stationary and depends on our actions. We propose using simple algorithms based on online learning to provably maintain calibration on non-i.i.d. data, and we show how to integrate these algorithms in Bayesian optimization with minimal overhead. Empirically, we find that calibrated Bayesian optimization converges to better optima in fewer steps, and we demonstrate improved performance on standard benchmark functions and hyperparameter optimization tasks.</p> </div> </div> </div> </li></ol> <h2 class="bibliography">2023</h2> <ol class="bibliography"><li> <div class="row"> <div class="col col-sm-2 abbr"> <abbr class="badge rounded w-100">PMLR</abbr> </div> <div id="pmlr-v216-foldager23a" class="col-sm-8"> <div class="title">On the role of model uncertainties in Bayesian optimisation</div> <div class="author"> Jonathan Foldager, Mikkel Jordahn, Lars K. Hansen, and <span class="more-authors" title="click to view 1 more author" onclick=" var element=$(this); element.attr('title', ''); var more_authors_text=element.text() == '1 more author' ? 'Michael R. Andersen' : '1 more author'; var cursorPosition=0; var textAdder=setInterval(function(){ element.html(more_authors_text.substring(0, cursorPosition + 1)); if (++cursorPosition == more_authors_text.length){ clearInterval(textAdder); } }, '10'); ">1 more author</span> </div> <div class="periodical"> <em>In Proceedings of the Thirty-Ninth Conference on Uncertainty in Artificial Intelligence</em>, 31 jul–04 aug 2023 </div> <div class="periodical"> </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a href="https://proceedings.mlr.press/v216/foldager23a/foldager23a.pdf" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">PDF</a> </div> <div class="abstract hidden"> <p>Bayesian Optimization (BO) is a popular method for black-box optimization, which relies on uncertainty as part of its decision-making process when deciding which experiment to perform next. However, not much work has addressed the effect of uncertainty on the performance of the BO algorithm and to what extent calibrated uncertainties improve the ability to find the global optimum. In this work, we provide an extensive study of the relationship between the BO performance (regret) and uncertainty calibration for popular surrogate models and acquisition functions, and compare them across both synthetic and real-world experiments. Our results show that Gaussian Processes, and more surprisingly, Deep Ensembles are strong surrogate models. Our results further show a positive association between calibration error and regret, but interestingly, this association disappears when we control for the type of surrogate model in the analysis. We also study the effect of recalibration and demonstrate that it generally does not lead to improved regret. Finally, we provide theoretical justification for why uncertainty calibration might be difficult to combine with BO due to the small sample sizes commonly used.</p> </div> </div> </div> </li></ol> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Teemu Elmeri Turpeinen. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>